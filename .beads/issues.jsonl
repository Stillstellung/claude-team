{"id":"cic-1be","title":"Add option to spawn sessions with --dangerously-skip-permissions flag","description":"Allow spawn_session tool to optionally start Claude Code with the --dangerously-skip-permissions flag. This enables automated multi-agent workflows where spawned workers don't require manual permission approvals. Should add a parameter like 'skip_permissions: bool = False' to spawn_session.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-11T22:21:18.727097-08:00","updated_at":"2025-12-11T22:24:29.885472-08:00","closed_at":"2025-12-11T22:24:29.885472-08:00"}
{"id":"cic-2rc","title":"Claude Code MCP configuration","description":"Configure and document how to use the MCP server from within Claude Code.\n\nUpdate ~/.claude/settings.json or project .claude/settings.json with:\n{\n  \"mcpServers\": {\n    \"claude-team\": {\n      \"command\": \"uv\",\n      \"args\": [\"run\", \"--directory\", \"/path/to/claude-iterm-controller\", \"python\", \"-m\", \"claude_team_mcp\"]\n    }\n  }\n}\n\nTest that:\n1. Claude Code can start the MCP server\n2. Tools appear when Claude Code starts\n3. spawn_session creates new Claude Code instances\n4. The manager session can coordinate work across spawned sessions\n\nDocument the workflow:\n- How to start a 'manager' Claude Code session\n- How to spawn worker sessions\n- Patterns for task distribution and result collection","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T21:59:18.755795-08:00","updated_at":"2025-12-11T22:16:16.817195-08:00","closed_at":"2025-12-11T22:16:16.817195-08:00","dependencies":[{"issue_id":"cic-2rc","depends_on_id":"cic-sic","type":"blocks","created_at":"2025-12-11T22:01:33.115111-08:00","created_by":"phaedrus"}]}
{"id":"cic-3tv","title":"send_message tool","description":"Implement the send_message MCP tool.\n\nTool signature:\n  send_message(\n    session_id: str,\n    message: str,\n    wait_for_response: bool = False,\n    timeout: float = 120.0\n  ) -\u003e dict\n\nBehavior:\n1. Look up session in registry\n2. Verify session is ready (not busy)\n3. Send message via iTerm2 async_send_text + Enter key (\\x0d)\n4. Update session status to 'busy'\n5. If wait_for_response:\n   - Poll JSONL file for new assistant message\n   - Return response content when idle_threshold reached\n6. Return {success: bool, response?: str, error?: str}\n\nUse existing primitives: send_prompt, wait_for_response from LinkedSession","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T21:57:04.18419-08:00","updated_at":"2025-12-11T22:14:40.900666-08:00","closed_at":"2025-12-11T22:14:40.900666-08:00","dependencies":[{"issue_id":"cic-3tv","depends_on_id":"cic-sic","type":"blocks","created_at":"2025-12-11T22:00:16.341656-08:00","created_by":"phaedrus"},{"issue_id":"cic-3tv","depends_on_id":"cic-y5n","type":"blocks","created_at":"2025-12-11T22:00:21.455408-08:00","created_by":"phaedrus"},{"issue_id":"cic-3tv","depends_on_id":"cic-ir7","type":"blocks","created_at":"2025-12-11T22:00:26.572752-08:00","created_by":"phaedrus"}]}
{"id":"cic-61r","title":"spawn_session sends commands before shell is ready - garbled cd/claude commands","description":"When spawning a session, the cd and claude commands are sometimes sent before the shell is fully initialized, resulting in garbled commands like 'escd' and 'sclaude' instead of 'cd' and 'claude'. This causes Claude to start in the wrong directory.\n\nThe start_claude_in_session function likely needs longer delays or shell readiness detection before sending commands.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-11T22:33:10.557911-08:00","updated_at":"2025-12-11T22:33:10.557911-08:00"}
{"id":"cic-67n","title":"Add MCP resources for session listing and status","description":"Add MCP resources as an alternative to tool calls for reading session state:\n\n- resource://sessions - List all managed sessions\n- resource://sessions/{session_id} - Get detailed status for a session\n- resource://sessions/{session_id}/screen - Get current screen content\n\nBenefits:\n- Resources can be more efficient for read-only operations\n- Better caching potential\n- Cleaner separation between read (resources) and write (tools) operations\n\nReference: FastMCP resource patterns","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-11T22:36:59.874532-08:00","updated_at":"2025-12-11T22:54:40.359544-08:00","closed_at":"2025-12-11T22:54:40.359544-08:00"}
{"id":"cic-6fw","title":"Worker agents should commit after closing issues","description":"When delegating work to spawned Claude sessions (like quad-1), the agent completed the implementation and closed the beads issue but did not create a git commit.\n\nThe task prompt should explicitly remind agents to:\n1. Mark issue in_progress\n2. Implement changes  \n3. Close issue\n4. Create git commit with issue reference\n\nConsider adding this to a standard task template or wrapper.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-11T22:37:40.317585-08:00","updated_at":"2025-12-11T22:37:40.317585-08:00"}
{"id":"cic-76s","title":"Add spawn_team tool for multi-pane layouts","description":"Add a spawn_team tool that creates a multi-pane window with Claude sessions in one call, using the existing create_multi_claude_layout primitive.\n\nAPI example:\nspawn_team(\n    projects={\n        'top_left': '/path/to/frontend',\n        'top_right': '/path/to/backend',\n        'bottom_left': '/path/to/api',\n        'bottom_right': '/path/to/tests'\n    },\n    layout='quad'  # or 'vertical', 'horizontal', 'triple_vertical'\n)\n\nReturns dict with all session IDs mapped to pane names.\n\nThis complements the split_from_session parameter by providing a simpler one-call approach for common multi-agent setups.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-11T22:27:24.172635-08:00","updated_at":"2025-12-11T22:35:17.701729-08:00","closed_at":"2025-12-11T22:35:17.701729-08:00"}
{"id":"cic-99e","title":"send_message wait_for_response times out despite response being available","description":"During testing, send_message with wait_for_response=true timed out after 30 seconds, but get_session_status showed the response was already visible in screen_preview and get_response successfully retrieved it. The response detection logic may have timing issues or isn't properly detecting when Claude finishes responding.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-11T22:21:13.609442-08:00","updated_at":"2025-12-11T22:23:17.212626-08:00","closed_at":"2025-12-11T22:23:17.212626-08:00"}
{"id":"cic-9a3","title":"Split pane targets wrong window - splits active pane instead of spawned window","description":"When using split_vertical or split_horizontal layout, the split happens in the currently active iTerm pane (the user's session) rather than in the window/pane created by a previous spawn_session call. This means all split sessions end up in the wrong window and share the same claude_session_id as the user's active session.\n\nExpected: Splits should target the window/tab created by the previous spawn_session\nActual: Splits target whatever pane is currently active in iTerm\n\nThis likely requires tracking the iTerm window/tab ID from spawn_session and explicitly targeting it for subsequent splits.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-11T22:24:21.485265-08:00","updated_at":"2025-12-11T22:25:46.525894-08:00","closed_at":"2025-12-11T22:25:46.525894-08:00"}
{"id":"cic-clx","title":"Integration testing","description":"Create integration tests for the MCP server.\n\nTests to write:\n1. Server startup/shutdown\n2. spawn_session creates working Claude session\n3. send_message delivers prompt and gets response\n4. list_sessions returns accurate status\n5. close_session properly cleans up\n6. Multiple concurrent sessions work correctly\n7. Session survives manager restart (registry persistence?)\n\nCreate: tests/test_integration.py\nUse pytest-asyncio for async tests.\n\nNote: These tests will actually spawn iTerm2 windows - they're integration tests, not unit tests. May want a --slow flag to skip in CI.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T21:57:37.020767-08:00","updated_at":"2025-12-11T21:57:37.020767-08:00","dependencies":[{"issue_id":"cic-clx","depends_on_id":"cic-ir7","type":"blocks","created_at":"2025-12-11T22:01:02.452509-08:00","created_by":"phaedrus"},{"issue_id":"cic-clx","depends_on_id":"cic-v98","type":"blocks","created_at":"2025-12-11T22:01:07.552437-08:00","created_by":"phaedrus"},{"issue_id":"cic-clx","depends_on_id":"cic-3tv","type":"blocks","created_at":"2025-12-11T22:01:12.657375-08:00","created_by":"phaedrus"},{"issue_id":"cic-clx","depends_on_id":"cic-f0j","type":"blocks","created_at":"2025-12-11T22:01:17.764995-08:00","created_by":"phaedrus"},{"issue_id":"cic-clx","depends_on_id":"cic-o7m","type":"blocks","created_at":"2025-12-11T22:01:22.873545-08:00","created_by":"phaedrus"},{"issue_id":"cic-clx","depends_on_id":"cic-kiu","type":"blocks","created_at":"2025-12-11T22:01:27.97972-08:00","created_by":"phaedrus"}]}
{"id":"cic-e5t","title":"Import existing Claude Code sessions into MCP registry","description":"Add ability to discover existing Claude Code sessions running in iTerm2 and import them into the MCP server's session registry for orchestration.\n\nUse cases:\n- User has Claude sessions already running before starting MCP server\n- Reconnect to sessions after MCP server restart\n- Adopt orphaned sessions\n\nImplementation ideas:\n- Scan iTerm2 windows/panes for Claude Code indicators\n- Match to JSONL session files in ~/.claude/projects/\n- Create managed session entries pointing to existing iTerm sessions\n- Tool: import_session(iterm_session_id?) or discover_sessions()","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-11T22:35:58.234202-08:00","updated_at":"2025-12-11T22:42:02.06357-08:00","closed_at":"2025-12-11T22:42:02.06357-08:00"}
{"id":"cic-el6","title":"Project setup with uv","description":"Migrate from pip/requirements.txt to uv for dependency management.\n\nTasks:\n- Remove old venv/ directory and requirements.txt\n- Create pyproject.toml with project metadata\n- Add dependencies: mcp (official Python SDK), iterm2\u003e=2.7\n- Set up uv.lock for reproducible builds\n- Create src/claude_team_mcp/ package structure\n- Add dev dependencies for testing\n\nThe package should be installable via 'uv pip install -e .' for development.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-11T21:55:37.86394-08:00","updated_at":"2025-12-11T22:05:29.36596-08:00","closed_at":"2025-12-11T22:05:29.36596-08:00"}
{"id":"cic-f0j","title":"get_response tool","description":"Implement the get_response MCP tool for async response retrieval.\n\nTool signature:\n  get_response(\n    session_id: str,\n    wait: bool = True,\n    timeout: float = 60.0,\n    since_message_id: Optional[str] = None\n  ) -\u003e dict\n\nBehavior:\n1. Look up session in registry\n2. Parse JSONL file for conversation state\n3. If wait=True and session is busy:\n   - Poll until idle_threshold reached or timeout\n4. Return {\n     status: str (idle/busy),\n     last_response: Optional[str],\n     message_id: str,\n     tool_uses: list[str],  # names of tools Claude used\n     is_complete: bool\n   }\n\nThis allows the manager to check on sessions without blocking.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T21:57:10.914024-08:00","updated_at":"2025-12-11T22:14:45.99241-08:00","closed_at":"2025-12-11T22:14:45.99241-08:00","dependencies":[{"issue_id":"cic-f0j","depends_on_id":"cic-sic","type":"blocks","created_at":"2025-12-11T22:00:31.71265-08:00","created_by":"phaedrus"},{"issue_id":"cic-f0j","depends_on_id":"cic-y5n","type":"blocks","created_at":"2025-12-11T22:00:36.848838-08:00","created_by":"phaedrus"}]}
{"id":"cic-hzk","title":"Claude Desktop configuration","description":"Document and test Claude Desktop integration.\n\nCreate: README.md section on Claude Desktop setup\nCreate: claude_desktop_config.json example\n\nConfiguration example:\n{\n  \"mcpServers\": {\n    \"claude-team\": {\n      \"command\": \"uv\",\n      \"args\": [\"run\", \"--directory\", \"/path/to/claude-iterm-controller\", \"python\", \"-m\", \"claude_team_mcp\"],\n      \"env\": {}\n    }\n  }\n}\n\nTest that:\n1. Claude Desktop can start the server\n2. Tools appear in Claude's tool list\n3. Spawning sessions works from Claude Desktop","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T21:57:44.009288-08:00","updated_at":"2025-12-11T21:59:13.59696-08:00","closed_at":"2025-12-11T21:59:13.59696-08:00"}
{"id":"cic-ir7","title":"spawn_session tool","description":"Implement the spawn_session MCP tool.\n\nTool signature:\n  spawn_session(\n    project_path: str,\n    session_name: Optional[str] = None,\n    layout: str = 'new_window',  # or 'split_vertical', 'split_horizontal'\n    resume_session: Optional[str] = None\n  ) -\u003e dict\n\nBehavior:\n1. Validate project_path exists\n2. Create iTerm2 window/pane based on layout parameter\n3. Start Claude Code in the new session\n4. Wait for Claude to initialize (with timeout)\n5. Discover Claude session ID from JSONL\n6. Register in SessionRegistry\n7. Return {session_id, project_path, status, claude_session_id}\n\nUse existing primitives: create_window, split_pane, start_claude, find_active_session","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T21:56:50.490822-08:00","updated_at":"2025-12-11T22:14:30.729012-08:00","closed_at":"2025-12-11T22:14:30.729012-08:00","dependencies":[{"issue_id":"cic-ir7","depends_on_id":"cic-sic","type":"blocks","created_at":"2025-12-11T21:59:50.759651-08:00","created_by":"phaedrus"},{"issue_id":"cic-ir7","depends_on_id":"cic-y5n","type":"blocks","created_at":"2025-12-11T21:59:55.884867-08:00","created_by":"phaedrus"},{"issue_id":"cic-ir7","depends_on_id":"cic-yo7","type":"blocks","created_at":"2025-12-11T22:00:00.999312-08:00","created_by":"phaedrus"}]}
{"id":"cic-kiu","title":"close_session tool","description":"Implement the close_session MCP tool.\n\nTool signature:\n  close_session(\n    session_id: str,\n    force: bool = False\n  ) -\u003e dict\n\nBehavior:\n1. Look up session in registry\n2. If not force and session is busy, return error\n3. Send Ctrl+C to interrupt any running operation\n4. Send '/exit' or Escape to exit Claude\n5. Optionally close the iTerm2 pane/window\n6. Remove from registry\n7. Return {success: bool, final_status: str}\n\nHandle edge cases: session already closed, iTerm2 window closed externally.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T21:57:23.924286-08:00","updated_at":"2025-12-11T22:14:56.166827-08:00","closed_at":"2025-12-11T22:14:56.166827-08:00","dependencies":[{"issue_id":"cic-kiu","depends_on_id":"cic-sic","type":"blocks","created_at":"2025-12-11T22:00:52.233455-08:00","created_by":"phaedrus"},{"issue_id":"cic-kiu","depends_on_id":"cic-y5n","type":"blocks","created_at":"2025-12-11T22:00:57.34777-08:00","created_by":"phaedrus"}]}
{"id":"cic-kv2","title":"Fix path detection for hyphenated project names in discover_sessions","description":"The discover_sessions tool incorrectly converts hyphens in project names to slashes when reconstructing paths from Claude's project directory slugs. For example, 'claude-iterm-controller' becomes 'claude/iterm/controller'.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-11T22:55:45.636842-08:00","updated_at":"2025-12-11T22:55:50.855993-08:00","closed_at":"2025-12-11T22:55:50.855993-08:00"}
{"id":"cic-o7m","title":"get_session_status tool","description":"Implement the get_session_status MCP tool.\n\nTool signature:\n  get_session_status(session_id: str) -\u003e dict\n\nReturns detailed status:\n{\n  session_id: str,\n  status: str (spawning/ready/busy/closed),\n  project_path: str,\n  is_responsive: bool,  # Can we read screen?\n  last_activity: str,\n  conversation_stats: {\n    total_messages: int,\n    user_messages: int,\n    assistant_messages: int,\n    last_user_prompt: Optional[str],\n    last_assistant_response_preview: Optional[str]\n  },\n  screen_preview: str  # Last few lines of terminal\n}\n\nCombines iTerm2 screen reading with JSONL parsing for full picture.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T21:57:17.40743-08:00","updated_at":"2025-12-11T22:14:51.082816-08:00","closed_at":"2025-12-11T22:14:51.082816-08:00","dependencies":[{"issue_id":"cic-o7m","depends_on_id":"cic-sic","type":"blocks","created_at":"2025-12-11T22:00:41.982891-08:00","created_by":"phaedrus"},{"issue_id":"cic-o7m","depends_on_id":"cic-y5n","type":"blocks","created_at":"2025-12-11T22:00:47.114277-08:00","created_by":"phaedrus"}]}
{"id":"cic-oz0","title":"Set BEADS_DIR when spawning sessions in worktrees","description":"When spawning Claude sessions in git worktrees, set the BEADS_DIR environment variable to point to the main repo's .beads directory.\n\nBackground: Beads has known worktree limitations (see steveyegge/beads PR #478). The database discovery fails because git rev-parse --show-toplevel returns the worktree path instead of the main repo.\n\nImplementation:\n- Detect if project_path is a worktree (check if .git is a file)\n- If so, resolve main repo path and set BEADS_DIR=/path/to/main/.beads\n- Pass this env var to start_claude_in_session()\n\nWorkarounds that work today:\n- bd --no-db (used by e5t-worker)\n- BEADS_NO_DAEMON=1\n- --sandbox mode","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-11T22:44:31.543033-08:00","updated_at":"2025-12-11T22:44:31.543033-08:00"}
{"id":"cic-qzu","title":"Claude Code Team Manager MCP Server","description":"Build an MCP server that allows one Claude Code session to spawn and manage a team of other Claude Code sessions via iTerm2. The server maintains persistent state tracking which iTerm windows/panes correspond to which Claude sessions, enabling coordination between multiple AI coding agents.\n\nKey capabilities:\n- Spawn new Claude Code sessions in iTerm2 windows/panes\n- Send prompts to managed sessions\n- Read responses and conversation state from sessions\n- Check session status (idle, processing, waiting)\n- Coordinate multi-session workflows\n\nTech stack:\n- Python with uv (replacing pip/venv)\n- Official MCP Python SDK (FastMCP)\n- Existing iTerm2 primitives from this project\n- JSONL session parsing for state access","status":"in_progress","priority":0,"issue_type":"epic","created_at":"2025-12-11T21:55:24.81561-08:00","updated_at":"2025-12-11T22:03:49.927399-08:00","dependencies":[{"issue_id":"cic-qzu","depends_on_id":"cic-el6","type":"blocks","created_at":"2025-12-11T21:58:00.016924-08:00","created_by":"phaedrus"},{"issue_id":"cic-qzu","depends_on_id":"cic-sic","type":"blocks","created_at":"2025-12-11T21:58:05.136279-08:00","created_by":"phaedrus"},{"issue_id":"cic-qzu","depends_on_id":"cic-y5n","type":"blocks","created_at":"2025-12-11T21:58:10.25382-08:00","created_by":"phaedrus"},{"issue_id":"cic-qzu","depends_on_id":"cic-ir7","type":"blocks","created_at":"2025-12-11T21:58:15.370467-08:00","created_by":"phaedrus"},{"issue_id":"cic-qzu","depends_on_id":"cic-v98","type":"blocks","created_at":"2025-12-11T21:58:20.494682-08:00","created_by":"phaedrus"},{"issue_id":"cic-qzu","depends_on_id":"cic-3tv","type":"blocks","created_at":"2025-12-11T21:58:25.637636-08:00","created_by":"phaedrus"},{"issue_id":"cic-qzu","depends_on_id":"cic-f0j","type":"blocks","created_at":"2025-12-11T21:58:30.766309-08:00","created_by":"phaedrus"},{"issue_id":"cic-qzu","depends_on_id":"cic-o7m","type":"blocks","created_at":"2025-12-11T21:58:35.890778-08:00","created_by":"phaedrus"},{"issue_id":"cic-qzu","depends_on_id":"cic-kiu","type":"blocks","created_at":"2025-12-11T21:58:41.016919-08:00","created_by":"phaedrus"},{"issue_id":"cic-qzu","depends_on_id":"cic-yo7","type":"blocks","created_at":"2025-12-11T21:58:46.137259-08:00","created_by":"phaedrus"},{"issue_id":"cic-qzu","depends_on_id":"cic-clx","type":"blocks","created_at":"2025-12-11T21:58:51.270767-08:00","created_by":"phaedrus"},{"issue_id":"cic-qzu","depends_on_id":"cic-hzk","type":"blocks","created_at":"2025-12-11T21:58:56.405378-08:00","created_by":"phaedrus"},{"issue_id":"cic-qzu","depends_on_id":"cic-2rc","type":"blocks","created_at":"2025-12-11T22:01:38.24671-08:00","created_by":"phaedrus"}]}
{"id":"cic-sic","title":"Core MCP server skeleton","description":"Create the basic FastMCP server structure with stdio transport.\n\nFiles to create:\n- src/claude_team_mcp/server.py - Main MCP server using FastMCP\n- src/claude_team_mcp/__init__.py - Package init\n- src/claude_team_mcp/__main__.py - Entry point for 'python -m claude_team_mcp'\n\nThe server should:\n- Use FastMCP for simple tool registration\n- Support stdio transport (for Claude Desktop integration)\n- Have a lifespan context manager for managing iTerm2 connection\n- Log startup/shutdown events\n\nReference the MCP Python SDK FastMCP patterns.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-11T21:55:50.916268-08:00","updated_at":"2025-12-11T22:07:27.445469-08:00","closed_at":"2025-12-11T22:07:27.445469-08:00","dependencies":[{"issue_id":"cic-sic","depends_on_id":"cic-el6","type":"blocks","created_at":"2025-12-11T21:59:35.404951-08:00","created_by":"phaedrus"}]}
{"id":"cic-uw8","title":"close_session should close iTerm2 pane/window","description":"Currently close_session removes the session from the registry but leaves the iTerm2 pane/window open. It should optionally (or by default) close the actual iTerm2 pane.\n\nConsider:\n- close_pane parameter (default true?)\n- If pane is last in window, close window\n- If pane is last in tab, close tab\n- Handle gracefully if iTerm2 session is already closed","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-11T22:35:52.972446-08:00","updated_at":"2025-12-11T22:54:49.346723-08:00","closed_at":"2025-12-11T22:54:49.346723-08:00"}
{"id":"cic-v6x","title":"send_message does not submit after paste - Enter key not working","description":"When send_message sends a multi-line message, it gets pasted (bracketed paste mode shows '[Pasted text #1 +20 lines]') but the message is not submitted. Short single-line messages work fine.\n\nThe issue appears specific to bracketed paste mode. Possible causes:\n- Claude Code may require a different key sequence after bracketed paste\n- There may be a timing issue needing delay after paste before submission key\n- The submission key after paste might not be Enter (\\x0d)\n\nNote: Single-line messages submit correctly with \\x0d.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-11T22:31:49.11264-08:00","updated_at":"2025-12-11T22:34:41.765313-08:00"}
{"id":"cic-v98","title":"list_sessions tool","description":"Implement the list_sessions MCP tool.\n\nTool signature:\n  list_sessions(\n    status_filter: Optional[str] = None  # ready, busy, all\n  ) -\u003e list[dict]\n\nReturns list of:\n{\n  session_id: str,\n  session_name: str,\n  project_path: str,\n  status: str,\n  claude_session_id: Optional[str],\n  last_activity: str (ISO timestamp),\n  message_count: int (from JSONL if available)\n}\n\nShould refresh status for each session before returning (check if Claude is idle or processing).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T21:56:57.538829-08:00","updated_at":"2025-12-11T22:14:35.813415-08:00","closed_at":"2025-12-11T22:14:35.813415-08:00","dependencies":[{"issue_id":"cic-v98","depends_on_id":"cic-sic","type":"blocks","created_at":"2025-12-11T22:00:06.110642-08:00","created_by":"phaedrus"},{"issue_id":"cic-v98","depends_on_id":"cic-y5n","type":"blocks","created_at":"2025-12-11T22:00:11.229202-08:00","created_by":"phaedrus"}]}
{"id":"cic-y5n","title":"Session registry module","description":"Create a session registry to track all spawned Claude sessions.\n\nFile: src/claude_team_mcp/registry.py\n\nThe SessionRegistry class should track:\n- session_id: str (unique identifier we assign)\n- iterm_session: iterm2.Session object\n- project_path: str (where Claude is running)\n- claude_session_id: Optional[str] (from JSONL file)\n- status: enum (spawning, ready, busy, closed)\n- created_at: datetime\n- last_activity: datetime\n\nMethods:\n- add(session_id, iterm_session, project_path) -\u003e ManagedSession\n- get(session_id) -\u003e Optional[ManagedSession]\n- list_all() -\u003e list[ManagedSession]\n- remove(session_id)\n- update_status(session_id, status)\n\nThis is the core state that makes the MCP server useful - it persists across tool calls.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T21:56:44.224268-08:00","updated_at":"2025-12-11T22:11:38.801878-08:00","closed_at":"2025-12-11T22:11:38.801878-08:00","dependencies":[{"issue_id":"cic-y5n","depends_on_id":"cic-el6","type":"blocks","created_at":"2025-12-11T21:59:40.523402-08:00","created_by":"phaedrus"}]}
{"id":"cic-yo7","title":"Refactor primitives for MCP server","description":"Extract and organize reusable code from existing files for the MCP server.\n\nCreate: src/claude_team_mcp/iterm_utils.py\n- Move key codes, send_text, send_key, send_prompt, read_screen from primitives.py\n- Add proper async context management for iTerm2 connection\n- Add connection pooling/reuse\n\nCreate: src/claude_team_mcp/session_state.py  \n- Move/adapt SessionParser, SessionState, Message from session_parser.py\n- Add caching for parsed sessions\n- Add methods for incremental updates (only parse new lines)\n\nKeep existing files working (they're useful for testing) but have them import from the new modules.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T21:57:30.493975-08:00","updated_at":"2025-12-11T22:09:39.949798-08:00","closed_at":"2025-12-11T22:09:39.949798-08:00","dependencies":[{"issue_id":"cic-yo7","depends_on_id":"cic-el6","type":"blocks","created_at":"2025-12-11T21:59:45.644071-08:00","created_by":"phaedrus"}]}
